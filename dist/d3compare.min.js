!function(t,e){"undefined"!=typeof module?module.exports=e():"function"==typeof define&&"object"==typeof define.amd?define(e):this[t]=e()}("d3compare",function(){"use strict";var t=function(t,e,a){if(a=a||{color:"#ff0000"},!d3)return void console.log("Error: d3.js library not found!");if(!t||d3.select(t).empty())return void console.log("Error: element for rendering not found!");var n=d3.select(t);n.html("");var r=Math.max(0,parseInt(n.style("width"),10)),l=Math.max(0,parseInt(n.style("height"),10));d3.select(t).append("style").html(".d3compare-svg { font-family: Arial; font-size: 12px;} .axis path, .axis line { fill: none; stroke: #000; shape-rendering: crispEdges; } .x.axis .tick line { display: none; } .x.axis path {  display: none; } ");var o=e.map(function(t){return t.monthName}),s=e.map(function(t){return t.values.map(function(t){return t.year})}),i=d3.set(d3.merge(s)).values().map(function(t){return+t}).sort(),d={top:20,right:70,bottom:30,left:70},u=r-d.left-d.right,c=l-d.top-d.bottom,f=Math.max.apply(Math,o.map(function(t){return t.length})),p=7,m=3,g=2,h=f*p,y=m*p,x=0,v=1,b=2,M=x,A=2*o.length*g;u<o.length*y+A?M=v:u<o.length*h+A&&(M=b);var B=d3.scale.ordinal().rangeRoundBands([0,u],.1).domain(o),k=d3.scale.ordinal().domain(i).rangeRoundBands([0,B.rangeBand()]),w=d3.scale.linear().range([c,0]).domain([0,d3.max(e,function(t){return d3.max(t.values,function(t){return t.value})})]),E=d3.scale.linear().domain([Math.min.apply(Math,i),Math.max.apply(Math,i)]).range(["#000000",a.color]),j=d3.svg.axis().scale(B).orient("bottom").tickFormat(function(t,e){return M===b?t.substring(0,m):M===v?e+1:t}),z=d3.svg.axis().scale(w).orient("left").tickFormat(d3.format(".1f")),F=d3.select(t).append("svg").classed("d3compare-svg",!0).attr("width",u+d.left+d.right).attr("height",c+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")");F.append("g").attr("class","x axis").attr("transform","translate(0,"+c+")").call(j),F.append("g").attr("class","y axis").call(z).append("text").attr("transform","rotate(-90)").attr("x",-c/2).attr("y",-70).attr("dy","1em").style("text-anchor","middle").text("Value");var I=F.selectAll(".monthBox").data(e).enter().append("g").attr("class","g").attr("transform",function(t){return"translate("+B(t.monthName)+",0)"});I.selectAll("rect").data(function(t){return t.values}).enter().append("rect").attr("class",function(t){return"bar-"+t.year}).classed("value-bar",!0).attr("width",k.rangeBand()-1).attr("x",function(t){return k(t.year)}).attr("y",function(t){return w(t.value||0)}).attr("height",function(t){return c-w(t.value||0)}).style("fill",function(t){return E(t.year)});var N=F.selectAll(".legend").data(i.slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+20*e+")"});a.legendMouse&&N.on("mouseover",function(t){F.selectAll(".value-bar:not(.bar-"+t+")").transition().style("fill","#efefef").duration(200)}).on("mouseout",function(){F.selectAll(".value-bar").transition().style("fill",function(t){return E(t.year)}).duration(200)}),N.append("rect").attr("x",u+8).attr("width",18).attr("height",18).style("fill",E),N.append("text").attr("x",u+30).attr("y",9).attr("dy",".35em").style("text-anchor","start").text(function(t){return t})};return{visualize:t}});